{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap ad8dc683f9d76d6fa39e","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///external {\"commonjs\":\"cornerstone-core\",\"commonjs2\":\"cornerstone-core\",\"amd\":\"cornerstone-core\",\"root\":\"cornerstone\"}","webpack:///./imageLoader/internal/index.js","webpack:///./version.js","webpack:///./imageLoader/wadors/metaData/getValue.js","webpack:///./imageLoader/wadouri/parseImageId.js","webpack:///external {\"commonjs\":\"dicom-parser\",\"commonjs2\":\"dicom-parser\",\"amd\":\"dicom-parser\",\"root\":\"dicomParser\"}","webpack:///./imageLoader/createImage.js","webpack:///./imageLoader/internal/options.js","webpack:///./imageLoader/wadors/metaDataManager.js","webpack:///./imageLoader/wadouri/dataSetCacheManager.js","webpack:///./imageLoader/colorSpaceConverters/index.js","webpack:///./imageLoader/convertColorSpace.js","webpack:///./imageLoader/decodeImageFrame.js","webpack:///./imageLoader/decodeJPEGBaseline8BitColor.js","webpack:///./imageLoader/getImageFrame.js","webpack:///./imageLoader/getMinMax.js","webpack:///./imageLoader/isColorImage.js","webpack:///./imageLoader/isJPEGBaseline8BitColor.js","webpack:///./imageLoader/webWorkerManager.js","webpack:///./imageLoader/wadors/findIndexOfString.js","webpack:///./imageLoader/wadors/getPixelData.js","webpack:///./imageLoader/wadors/metaData/getNumberValue.js","webpack:///./imageLoader/wadors/metaData/getNumberValues.js","webpack:///./imageLoader/wadouri/fileManager.js","webpack:///./imageLoader/wadouri/getEncapsulatedImageFrame.js","webpack:///./imageLoader/wadouri/getUncompressedImageFrame.js","webpack:///./imageLoader/wadouri/loadFileRequest.js","webpack:///./imageLoader/wadouri/metaData/getImagePixelModule.js","webpack:///./imageLoader/wadouri/metaData/getLUTs.js","webpack:///./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js","webpack:///./imageLoader/wadouri/metaData/getNumberValues.js","webpack:///./imageLoader/wadouri/unpackBinaryFrame.js","webpack:///./imageLoader/configure.js","webpack:///./imageLoader/wadors/index.js","webpack:///./imageLoader/wadouri/index.js","webpack:///./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js","webpack:///./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js","webpack:///./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js","webpack:///./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js","webpack:///./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js","webpack:///./imageLoader/index.js","webpack:///./imageLoader/internal/xhrRequest.js","webpack:///./imageLoader/wadors/loadImage.js","webpack:///./imageLoader/wadors/metaData/getNumberString.js","webpack:///./imageLoader/wadors/metaData/index.js","webpack:///./imageLoader/wadors/metaData/metaDataProvider.js","webpack:///./imageLoader/wadors/stringToUint8Array.js","webpack:///./imageLoader/wadors/uint8ArrayToString.js","webpack:///./imageLoader/wadouri/loadImage.js","webpack:///./imageLoader/wadouri/metaData/index.js","webpack:///./imageLoader/wadouri/metaData/metaDataProvider.js"],"names":["internal","xhrRequest","setOptions","getOptions","element","index","defaultValue","Value","length","imageId","firstColonIndex","indexOf","url","substring","frameIndex","frame","frameStr","substr","parseInt","scheme","pixelData","transferSyntax","options","canvas","document","createElement","deferred","Deferred","imageFrame","decodePromise","then","imagePlaneModule","cornerstone","metaData","get","voiLutModule","modalityLutModule","sopCommonModule","color","photometricInterpretation","setPixelDataType","height","rows","width","columns","context","getContext","imageData","createImageData","data","minMax","smallestPixelValue","min","largestPixelValue","max","image","intercept","rescaleIntercept","slope","rescaleSlope","invert","minPixelValue","maxPixelValue","render","undefined","sizeInBytes","rowPixelSpacing","pixelSpacing","columnPixelSpacing","windowCenter","windowWidth","decodeTimeInMS","getPixelData","renderColorImage","getCanvas","lastImageIdDrawn","putImageData","renderGrayscaleImage","modalityLUTSequence","isModalityLUTForDisplay","sopClassUID","modalityLUT","voiLUTSequence","voiLUT","maxVoi","minVoi","resolve","promise","sopClassUid","bitsAllocated","pixelRepresentation","Uint16Array","Int16Array","Uint8Array","beforeSend","imageCreated","strict","newOptions","imageIds","add","metadata","remove","purge","dicomParser","loadedDataSets","promises","isLoaded","uri","Error","dataSet","load","loadRequest","alreadyLoadedpromise","cacheCount","loadDeferred","dicomPart10AsArrayBuffer","byteArray","parseDicom","error","reject","always","unload","default","convertColorSpace","convertRGB","rgbaBuffer","planarConfiguration","convertYBRFull","addDecodeTask","priority","transferList","transferPixelData","buffer","addTask","decodeImageFrame","samplesPerPixel","start","Date","getTime","imgBlob","Blob","type","r","FileReader","readAsBinaryString","readAsArrayBuffer","onload","img","Image","drawImage","getImageData","end","onerror","src","window","btoa","arrayBufferToString","result","binaryToString","String","fromCharCode","apply","Array","prototype","slice","binary","decodeURIComponent","escape","_error","URIError","imagePixelModule","redPaletteColorLookupTableDescriptor","greenPaletteColorLookupTableDescriptor","bluePaletteColorLookupTableDescriptor","redPaletteColorLookupTableData","greenPaletteColorLookupTableData","bluePaletteColorLookupTableData","storedPixelData","numPixels","storedPixel","Math","nextTaskId","tasks","webWorkers","defaultConfig","maxWebWorkers","navigator","hardwareConcurrency","startWebWorkersOnDemand","webWorkerPath","webWorkerTaskPaths","taskConfiguration","decodeTask","loadCodecsOnStartup","initializeCodecsOnStartup","codecsPath","usePDFJS","config","statistics","numWebWorkers","numTasksQueued","numTasksExecuting","numTasksCompleted","totalTaskTimeInMS","totalTimeDelayedInMS","startTaskOnWebWorker","i","status","task","shift","added","worker","postMessage","taskType","workerIndex","spawnWebWorker","handleMessageFromWorker","msg","Worker","push","addEventListener","initialize","configObject","loadWebWorkerTask","sourcePath","taskConfig","Object","assign","taskId","splice","setTaskPriority","cancelTask","reason","getStatistics","findIndexOfString","checkToken","token","dataOffset","endIndex","str","offset","mediaType","headers","accept","loadPromise","imageFrameAsArrayBuffer","response","tokenIndex","header","split","boundary","findBoundary","contentType","findContentType","trim","value","parseFloat","minimumLength","values","files","file","fileIndex","getEncapsulatedImageFrame","framesAreFragmented","numberOfFrames","intString","pixelDataElement","elements","x7fe00010","fragments","basicOffsetTable","readEncapsulatedImageFrame","createJPEGBasicOffsetTable","readEncapsulatedPixelDataFromFragments","uint16","pixelDataOffset","pixelsPerFrame","frameOffset","parsedImageId","fileReader","e","target","getLutDescriptor","tag","getLutData","lutDataSet","lutDescriptor","lut","lutData","numLutEntries","populatePaletteColorLut","x00281101","populateSmallestLargestPixelValues","int16","getImagePixelModule","string","bitsStored","highBit","pixelAspectRatio","getLUT","numLUTEntries","firstValueMapped","numBitsPerEntry","id","getLUTs","lutSequence","items","luts","getMinStoredPixelValue","getModalityLUTOutputPixelRepresentation","floatString","minStoredPixelValue","minModalityLutValue","x00283000","getNumberValues","valueAsString","bytePos","floor","byte","bitPos","isBitSet","Boolean","getNumberString","getNumberValue","getValue","metaDataProvider","loadImage","metaDataManager","dataSetCacheManager","fileManager","getUncompressedImageFrame","loadFileRequest","loadImageFromPromise","getLoaderForScheme","parseImageId","unpackBinaryFrame","palIndex","rgbaIndex","rData","gData","bData","len","rgbIndex","rIndex","gIndex","bIndex","ybrIndex","y","cb","cr","yIndex","cbIndex","crIndex","xhr","XMLHttpRequest","open","responseType","keys","forEach","key","setRequestHeader","onreadystatechange","readyState","onprogress","oProgress","lengthComputable","loaded","total","percentComplete","round","events","trigger","send","getTransferSyntaxForContentType","imagePromise","loadTimeInMS","fail","registerImageLoader","modality","seriesInstanceUID","seriesNumber","studyInstanceUID","seriesDate","parseDA","seriesTime","parseTM","patientAge","patientSize","patientWeight","imageOrientationPatient","imagePositionPatient","sliceThickness","sliceLocation","rescaleType","sopInstanceUID","radiopharmaceuticalInfo","radiopharmaceuticalStartTime","radionuclideTotalDose","radionuclideHalfLife","addProvider","uint","j","charCodeAt","addDecache","decache","encapsulatedPixelData","dataSetPromise","loadEnd","totalTimeInMS","loader","frameOfReferenceUID","modalityLUTOutputPixelRepresentation","x00283010","x00540016","firstRadiopharmaceuticalInfoDataSet"],"mappings":"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","file":"cornerstoneWADOImageLoader.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"cornerstone-core\"), require(\"dicom-parser\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cornerstoneWADOImageLoader\", [\"jquery\", \"cornerstone-core\", \"dicom-parser\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cornerstoneWADOImageLoader\"] = factory(require(\"jquery\"), require(\"cornerstone-core\"), require(\"dicom-parser\"));\n\telse\n\t\troot[\"cornerstoneWADOImageLoader\"] = factory(root[\"$\"], root[\"cornerstone\"], root[\"dicomParser\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_6__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 45);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ad8dc683f9d76d6fa39e","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"cornerstone-core\",\"commonjs2\":\"cornerstone-core\",\"amd\":\"cornerstone-core\",\"root\":\"cornerstone\"}\n// module id = 1\n// module chunks = 0","import { default as xhrRequest } from './xhrRequest';\nimport { setOptions, getOptions } from './options';\n\nconst internal = {\n  xhrRequest,\n  setOptions,\n  getOptions\n};\n\nexport { setOptions, getOptions, xhrRequest, internal };\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/index.js","export default '0.14.6';\n\n\n\n// WEBPACK FOOTER //\n// ./version.js","/**\n * Returns the raw value\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param {Number} [index] - the index of the value in a multi-valued element, default is 0\n * @param {*} [defaultValue] - The default value to return if the element does not exist\n * @returns {*}\n */\nexport default function (element, index = 0, defaultValue) {\n  if (!element) {\n    return defaultValue;\n  }\n  // Value is not present if the attribute has a zero length value\n  if (!element.Value) {\n    return defaultValue;\n  }\n  // make sure we have the specified index\n  if (element.Value.length <= index) {\n    return defaultValue;\n  }\n\n  return element.Value[index];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getValue.js","/**\n * Build a url by parsing out the url scheme and frame index from the imageId\n *\n * @param imageId\n * @return {{scheme: string, url: string, frame: *}}\n */\nexport default function (imageId) {\n  const firstColonIndex = imageId.indexOf(':');\n  let url = imageId.substring(firstColonIndex + 1);\n  const frameIndex = url.indexOf('frame=');\n  let frame;\n\n  if (frameIndex !== -1) {\n    const frameStr = url.substr(frameIndex + 6);\n\n    frame = parseInt(frameStr, 10);\n    url = url.substr(0, frameIndex - 1);\n  }\n\n  return {\n    scheme: imageId.substr(0, firstColonIndex),\n    url,\n    frame\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/parseImageId.js","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"dicom-parser\",\"commonjs2\":\"dicom-parser\",\"amd\":\"dicom-parser\",\"root\":\"dicomParser\"}\n// module id = 6\n// module chunks = 0","import $ from 'jquery';\nimport getImageFrame from './getImageFrame';\nimport decodeImageFrame from './decodeImageFrame';\nimport isColorImageFn from './isColorImage';\nimport convertColorSpace from './convertColorSpace';\nimport getMinMax from './getMinMax';\nimport isJPEGBaseline8BitColor from './isJPEGBaseline8BitColor';\nimport * as cornerstone from 'cornerstone-core';\n\nlet lastImageIdDrawn = '';\n\n/**\n * Check whether the modality LUT is meant to be used for display purposes\n * For XA and XRF images, the modality LUT is not meant to be used.\n *\n * See https://groups.google.com/forum/#!searchin/comp.protocols.dicom/Modality$20LUT$20XA/comp.protocols.dicom/UBxhOZ2anJ0/D0R_QP8V2wIJ\n *\n * @param {String} sopClassUid\n * @return {boolean} Whether or not the Modality LUT should be used for image display\n */\nfunction isModalityLUTForDisplay (sopClassUid) {\n  return sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.1' && // XA\n         sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.2.1'; // XRF\n}\n\n/**\n * Helper function to set pixel data to the right typed array.  This is needed because web workers\n * can transfer array buffers but not typed arrays\n * @param imageFrame\n */\nfunction setPixelDataType (imageFrame) {\n  if (imageFrame.bitsAllocated === 16) {\n    if (imageFrame.pixelRepresentation === 0) {\n      imageFrame.pixelData = new Uint16Array(imageFrame.pixelData);\n    } else {\n      imageFrame.pixelData = new Int16Array(imageFrame.pixelData);\n    }\n  } else {\n    imageFrame.pixelData = new Uint8Array(imageFrame.pixelData);\n  }\n}\n\n/**\n * Create an Image\n *\n * @param {String} imageId\n * @param {Array} pixelData\n * @param {String} transferSyntax\n * @param {Object} options\n *\n * @returns {Promise}\n */\nexport default function (imageId, pixelData, transferSyntax, options) {\n  const canvas = document.createElement('canvas');\n  const deferred = $.Deferred();\n  const imageFrame = getImageFrame(imageId);\n  const decodePromise = decodeImageFrame(imageFrame, transferSyntax, pixelData, canvas, options);\n\n  decodePromise.then(function (imageFrame) {\n    // var imagePixelModule = metaDataProvider('imagePixelModule', imageId);\n    const imagePlaneModule = cornerstone.metaData.get('imagePlaneModule', imageId) || {};\n    const voiLutModule = cornerstone.metaData.get('voiLutModule', imageId) || {};\n    const modalityLutModule = cornerstone.metaData.get('modalityLutModule', imageId) || {};\n    const sopCommonModule = cornerstone.metaData.get('sopCommonModule', imageId) || {};\n    const color = isColorImageFn(imageFrame.photometricInterpretation);\n\n    // JPEGBaseline (8 bits) is already returning the pixel data in the right format (rgba)\n    // because it's using a canvas to load and decode images.\n    if (!isJPEGBaseline8BitColor(imageFrame, transferSyntax)) {\n      setPixelDataType(imageFrame);\n\n      // convert color space\n      if (color) {\n        // setup the canvas context\n        canvas.height = imageFrame.rows;\n        canvas.width = imageFrame.columns;\n\n        const context = canvas.getContext('2d');\n        const imageData = context.createImageData(imageFrame.columns, imageFrame.rows);\n\n        convertColorSpace(imageFrame, imageData);\n        imageFrame.imageData = imageData;\n        imageFrame.pixelData = imageData.data;\n\n        // calculate smallest and largest PixelValue of the converted pixelData\n        const minMax = getMinMax(imageFrame.pixelData);\n\n        imageFrame.smallestPixelValue = minMax.min;\n        imageFrame.largestPixelValue = minMax.max;\n      }\n    }\n\n    const image = {\n      imageId,\n      color,\n      columns: imageFrame.columns,\n      rows: imageFrame.rows,\n      width: imageFrame.columns,\n      height: imageFrame.rows,\n      intercept: modalityLutModule.rescaleIntercept || 0,\n      slope: modalityLutModule.rescaleSlope || 1,\n      invert: imageFrame.photometricInterpretation === 'MONOCHROME1',\n      minPixelValue: imageFrame.smallestPixelValue,\n      maxPixelValue: imageFrame.largestPixelValue,\n      render: undefined, // set below\n      sizeInBytes: imageFrame.pixelData.length,\n      rowPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[0] : undefined,\n      columnPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[1] : undefined,\n      windowCenter: voiLutModule.windowCenter ? voiLutModule.windowCenter[0] : undefined,\n      windowWidth: voiLutModule.windowWidth ? voiLutModule.windowWidth[0] : undefined,\n      decodeTimeInMS: imageFrame.decodeTimeInMS\n    };\n\n    // add function to return pixel data\n    image.getPixelData = () => imageFrame.pixelData;\n\n    // Setup the renderer\n    if (image.color) {\n      image.render = cornerstone.renderColorImage;\n      image.getCanvas = function () {\n        if (lastImageIdDrawn === imageId) {\n          return canvas;\n        }\n\n        canvas.height = image.rows;\n        canvas.width = image.columns;\n        const context = canvas.getContext('2d');\n\n        context.putImageData(imageFrame.imageData, 0, 0);\n        lastImageIdDrawn = imageId;\n\n        return canvas;\n      };\n\n    } else {\n      image.render = cornerstone.renderGrayscaleImage;\n    }\n\n    // Modality LUT\n    if (modalityLutModule.modalityLUTSequence &&\n      modalityLutModule.modalityLUTSequence.length > 0 &&\n      isModalityLUTForDisplay(sopCommonModule.sopClassUID)) {\n      image.modalityLUT = modalityLutModule.modalityLUTSequence[0];\n    }\n\n    // VOI LUT\n    if (voiLutModule.voiLUTSequence &&\n      voiLutModule.voiLUTSequence.length > 0) {\n      image.voiLUT = voiLutModule.voiLUTSequence[0];\n    }\n\n    // set the ww/wc to cover the dynamic range of the image if no values are supplied\n    if (image.windowCenter === undefined || image.windowWidth === undefined) {\n      if (image.color) {\n        image.windowWidth = 255;\n        image.windowCenter = 128;\n      } else {\n        const maxVoi = image.maxPixelValue * image.slope + image.intercept;\n        const minVoi = image.minPixelValue * image.slope + image.intercept;\n\n        image.windowWidth = maxVoi - minVoi;\n        image.windowCenter = (maxVoi + minVoi) / 2;\n      }\n    }\n    deferred.resolve(image);\n  });\n\n  return deferred.promise();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/createImage.js","let options = {\n  // callback allowing customization of the xhr (e.g. adding custom auth headers, cors, etc)\n  beforeSend (/* xhr */) {\n  },\n  // callback allowing modification of newly created image objects\n  imageCreated (/* image */) {\n  },\n  strict: true\n};\n\nexport function setOptions (newOptions) {\n  options = newOptions;\n}\n\nexport function getOptions () {\n  return options;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/options.js","// TODO: Is this being used at all???\nlet imageIds = [];\n\nfunction add (imageId, metadata) {\n  imageIds[imageId] = metadata;\n}\n\nfunction get (imageId) {\n  return imageIds[imageId];\n}\n\nfunction remove (imageId) {\n  imageIds[imageId] = undefined;\n}\n\nfunction purge () {\n  imageIds = [];\n}\n\nexport default {\n  add,\n  get,\n  remove,\n  purge\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaDataManager.js","import $ from 'jquery';\nimport * as dicomParser from 'dicom-parser';\nimport { xhrRequest } from '../internal';\n\n/**\n * This object supports loading of DICOM P10 dataset from a uri and caching it so it can be accessed\n * by the caller.  This allows a caller to access the datasets without having to go through cornerstone's\n * image loader mechanism.  One reason a caller may need to do this is to determine the number of frames\n * in a multiframe sop instance so it can create the imageId's correctly.\n */\nlet loadedDataSets = {};\nlet promises = {};\n\n/**\n * Returns true if the wadouri for the specified index has been loaded\n *\n * @param uri\n * @return {boolean} Whether or not the DataSet is in the cache\n */\nfunction isLoaded (uri) {\n  return loadedDataSets[uri] !== undefined;\n}\n\n/**\n * Retrieve a loaded DataSet from the cache\n *\n * @param {String} uri\n * @return {DataSet}\n * @throws If the DataSet is not in the cache\n */\nfunction get (uri) {\n  // if already loaded return it right away\n  if (!loadedDataSets[uri]) {\n    throw new Error('dataSetCacheManager.get: DataSet has not been loaded yet');\n  }\n\n  return loadedDataSets[uri].dataSet;\n}\n\n/**\n * Loads the dicom dataset from the wadouri sp\n *\n * @param {String} uri\n * @param loadRequest\n * @param {String} imageId\n * @return {*}\n */\nfunction load (uri, loadRequest, imageId) {\n  loadRequest = loadRequest || xhrRequest;\n\n  // if already loaded return it right away\n  if (loadedDataSets[uri]) {\n    // console.log('using loaded dataset ' + uri);\n    const alreadyLoadedpromise = $.Deferred();\n\n    loadedDataSets[uri].cacheCount++;\n    alreadyLoadedpromise.resolve(loadedDataSets[uri].dataSet);\n\n    return alreadyLoadedpromise;\n  }\n\n  // if we are currently loading this uri, return its promise\n  if (promises[uri]) {\n    // console.log('returning existing load promise for ' + uri);\n    return promises[uri];\n  }\n\n  // console.log('loading ' + uri);\n\n  // This uri is not loaded or being loaded, load it via an xhrRequest\n  const promise = loadRequest(uri, imageId);\n\n  // handle success and failure of the XHR request load\n  const loadDeferred = $.Deferred();\n\n  promise.then(function (dicomPart10AsArrayBuffer/* , xhr*/) {\n    const byteArray = new Uint8Array(dicomPart10AsArrayBuffer);\n\n    // Reject the promise if parsing the dicom file fails\n    let dataSet;\n\n    try {\n      dataSet = dicomParser.parseDicom(byteArray);\n    } catch (error) {\n      loadDeferred.reject(error);\n\n      return;\n    }\n\n    loadedDataSets[uri] = {\n      dataSet,\n      cacheCount: 1\n    };\n    loadDeferred.resolve(dataSet);\n    // done loading, remove the promise\n    delete promises[uri];\n  }, function (error) {\n    loadDeferred.reject(error);\n  }).always(function () {\n      // error thrown, remove the promise\n    delete promises[uri];\n  });\n\n  promises[uri] = loadDeferred;\n\n  return loadDeferred;\n}\n\n/**\n * Remove the cached/loaded dicom dataset for the specified wadouri to free up memory\n *\n * @param {String} uri\n */\nfunction unload (uri) {\n  // console.log('unload for ' + uri);\n  if (loadedDataSets[uri]) {\n    loadedDataSets[uri].cacheCount--;\n    if (loadedDataSets[uri].cacheCount === 0) {\n      // console.log('removing loaded dataset for ' + uri);\n      delete loadedDataSets[uri];\n    }\n  }\n}\n\n/**\n * Removes all cached datasets from memory\n */\nfunction purge () {\n  loadedDataSets = {};\n  promises = {};\n}\n\nexport default {\n  isLoaded,\n  load,\n  unload,\n  purge,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/dataSetCacheManager.js","export { default as convertRGBColorByPixel } from './convertRGBColorByPixel';\nexport { default as convertRGBColorByPlane } from './convertRGBColorByPlane';\nexport { default as convertYBRFullByPixel } from './convertYBRFullByPixel';\nexport { default as convertYBRFullByPlane } from './convertYBRFullByPlane';\nexport { default as convertPALETTECOLOR } from './convertPALETTECOLOR';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/index.js","import { convertRGBColorByPixel, convertRGBColorByPlane,\n         convertYBRFullByPixel, convertYBRFullByPlane,\n         convertPALETTECOLOR } from './colorSpaceConverters';\n\n/**\n * Convert an array from RGB color space to RGBA\n *\n * @param {ImageFrame} imageFrame\n * @param {CanvasPixelArray} rgbaBuffer\n */\nfunction convertRGB (imageFrame, rgbaBuffer) {\n  if (imageFrame.planarConfiguration === 0) {\n    convertRGBColorByPixel(imageFrame.pixelData, rgbaBuffer);\n  } else {\n    convertRGBColorByPlane(imageFrame.pixelData, rgbaBuffer);\n  }\n}\n\n/**\n * Convert an array from YBRFull color space to RGBA\n *\n * @param {ImageFrame} imageFrame\n * @param {CanvasPixelArray} rgbaBuffer\n */\nfunction convertYBRFull (imageFrame, rgbaBuffer) {\n  if (imageFrame.planarConfiguration === 0) {\n    convertYBRFullByPixel(imageFrame.pixelData, rgbaBuffer);\n  } else {\n    convertYBRFullByPlane(imageFrame.pixelData, rgbaBuffer);\n  }\n}\n\n/**\n * Convert the pixel data from the input color space to RGBA\n * based on the photometric interpretation of the image frame.\n *\n * @param {ImageFrame} imageFrame\n * @param {ImageData} imageData\n * @throws If the PhotometricInterpretation has no known color space conversion approach\n */\nexport default function convertColorSpace (imageFrame, imageData) {\n  const rgbaBuffer = imageData.data;\n  const photometricInterpretation = imageFrame.photometricInterpretation;\n\n  if (photometricInterpretation === 'RGB') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (photometricInterpretation === 'YBR_RCT') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (photometricInterpretation === 'YBR_ICT') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (photometricInterpretation === 'PALETTE COLOR') {\n    convertPALETTECOLOR(imageFrame, rgbaBuffer);\n  } else if (photometricInterpretation === 'YBR_FULL_422') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (photometricInterpretation === 'YBR_FULL') {\n    convertYBRFull(imageFrame, rgbaBuffer);\n  } else {\n    throw new Error(`No color space conversion for photometric interpretation ${photometricInterpretation}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/convertColorSpace.js","import webWorkerManager from './webWorkerManager';\nimport decodeJPEGBaseline8BitColor from './decodeJPEGBaseline8BitColor';\n\n/**\n * Add decode task\n *\n * @param imageFrame\n * @param transferSyntax\n * @param pixelData\n * @param options\n *\n * @return {Object}\n */\nfunction addDecodeTask (imageFrame, transferSyntax, pixelData, options) {\n  const priority = options.priority || undefined;\n  const transferList = options.transferPixelData ? [pixelData.buffer] : undefined;\n\n  return webWorkerManager.addTask(\n    'decodeTask',\n    {\n      imageFrame,\n      transferSyntax,\n      pixelData,\n      options\n    }, priority, transferList).promise;\n}\n\n/**\n * Decode image frame\n *\n * @param {ImageFrame} imageFrame\n * @param {String} transferSyntax\n * @param {Array} pixelData\n * @param {HTMLCanvasElement} canvas\n * @param {Object} options\n *\n * @return {Object}\n */\nfunction decodeImageFrame (imageFrame, transferSyntax, pixelData, canvas, options) {\n  options = options || {};\n\n  // TODO: Turn this into a switch statement instead\n  if (transferSyntax === '1.2.840.10008.1.2') {\n    // Implicit VR Little Endian\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.1') {\n    // Explicit VR Little Endian\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.2') {\n    // Explicit VR Big Endian (retired)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.1.99') {\n    // Deflate transfer syntax (deflated by dicomParser)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.5') {\n    // RLE Lossless\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.50') {\n    // JPEG Baseline lossy process 1 (8 bit)\n\n    // Handle 8-bit JPEG Baseline color images using the browser's built-in\n    // JPEG decoding\n    if (imageFrame.bitsAllocated === 8 &&\n       (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\n      return decodeJPEGBaseline8BitColor(imageFrame, pixelData, canvas);\n    }\n\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.51') {\n    // JPEG Baseline lossy process 2 & 4 (12 bit)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.57') {\n    // JPEG Lossless, Nonhierarchical (Processes 14)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.70') {\n    // JPEG Lossless, Nonhierarchical (Processes 14 [Selection 1])\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.80') {\n    // JPEG-LS Lossless Image Compression\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.81') {\n    // JPEG-LS Lossy (Near-Lossless) Image Compression\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.90') {\n    // JPEG 2000 Lossless\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.91') {\n    // JPEG 2000 Lossy\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  }\n\n  /* Don't know if these work...\n   // JPEG 2000 Part 2 Multicomponent Image Compression (Lossless Only)\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.92\")\n   {\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\n   }\n   // JPEG 2000 Part 2 Multicomponent Image Compression\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.93\")\n   {\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\n   }\n   */\n\n  throw new Error(`No decoder for transfer syntax ${transferSyntax}`);\n}\n\nexport default decodeImageFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/decodeImageFrame.js","import $ from 'jquery';\n\nfunction arrayBufferToString (buffer) {\n  return binaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\n}\n\nfunction binaryToString (binary) {\n  let error;\n\n  try {\n    return decodeURIComponent(escape(binary));\n  } catch (_error) {\n    error = _error;\n    if (error instanceof URIError) {\n      return binary;\n    }\n    throw error;\n\n  }\n}\n\n/**\n * Special decoder for 8 bit jpeg that leverages the browser's built in JPEG decoder for increased performance\n *\n * @param {ImageFrame} imageFrame\n * @param {Uint8Array} pixelData\n * @param {HTMLCanvasElement} canvas\n */\nexport default function (imageFrame, pixelData, canvas) {\n  const start = new Date().getTime();\n  const deferred = $.Deferred();\n\n  const imgBlob = new Blob([pixelData], { type: 'image/jpeg' });\n\n  const r = new FileReader();\n\n  if (r.readAsBinaryString === undefined) {\n    r.readAsArrayBuffer(imgBlob);\n  } else {\n    r.readAsBinaryString(imgBlob); // doesn't work on IE11\n  }\n\n  r.onload = function () {\n    const img = new Image();\n\n    img.onload = function () {\n      canvas.height = img.height;\n      canvas.width = img.width;\n      imageFrame.rows = img.height;\n      imageFrame.columns = img.width;\n      const context = canvas.getContext('2d');\n\n      context.drawImage(this, 0, 0);\n      const imageData = context.getImageData(0, 0, img.width, img.height);\n      const end = new Date().getTime();\n\n      imageFrame.pixelData = imageData.data;\n      imageFrame.imageData = imageData;\n      imageFrame.decodeTimeInMS = end - start;\n      deferred.resolve(imageFrame);\n    };\n    img.onerror = function (error) {\n      deferred.reject(error);\n    };\n    if (r.readAsBinaryString === undefined) {\n      img.src = `data:image/jpeg;base64,${window.btoa(arrayBufferToString(r.result))}`;\n    } else {\n      img.src = `data:image/jpeg;base64,${window.btoa(r.result)}`; // doesn't work on IE11\n    }\n\n  };\n\n  return deferred.promise();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/decodeJPEGBaseline8BitColor.js","import * as cornerstone from 'cornerstone-core';\n\n/**\n * @typedef {Object} ImageFrame\n *\n * @param {Number} samplesPerPixel\n * @param {String} photometricInterpretation\n * @param {Number} planarConfiguration\n * @param {Number} rows\n * @param {Number} columns\n * @param {Number} bitsAllocated\n * @param {Number} pixelRepresentation\n * @param {Number} smallestPixelValue\n * @param {Number} largestPixelValue\n * @param {String} redPaletteColorLookupTableDescriptor\n * @param {String} greenPaletteColorLookupTableDescriptor\n * @param {String} bluePaletteColorLookupTableDescriptor\n * @param {Array} redPaletteColorLookupTableData\n * @param {Array} greenPaletteColorLookupTableData\n * @param {Array} bluePaletteColorLookupTableData\n * @param {Array} pixelData\n */\n\n/**\n * Construct an ImageFrame object from an image's metadata\n *\n * @param imageId The image id\n * @return {ImageFrame} The image frame structure\n */\nexport default function (imageId) {\n  const imagePixelModule = cornerstone.metaData.get('imagePixelModule', imageId);\n\n  return {\n    samplesPerPixel: imagePixelModule.samplesPerPixel,\n    photometricInterpretation: imagePixelModule.photometricInterpretation,\n    planarConfiguration: imagePixelModule.planarConfiguration,\n    rows: imagePixelModule.rows,\n    columns: imagePixelModule.columns,\n    bitsAllocated: imagePixelModule.bitsAllocated,\n    pixelRepresentation: imagePixelModule.pixelRepresentation, // 0 = unsigned,\n    smallestPixelValue: imagePixelModule.smallestPixelValue,\n    largestPixelValue: imagePixelModule.largestPixelValue,\n    redPaletteColorLookupTableDescriptor: imagePixelModule.redPaletteColorLookupTableDescriptor,\n    greenPaletteColorLookupTableDescriptor: imagePixelModule.greenPaletteColorLookupTableDescriptor,\n    bluePaletteColorLookupTableDescriptor: imagePixelModule.bluePaletteColorLookupTableDescriptor,\n    redPaletteColorLookupTableData: imagePixelModule.redPaletteColorLookupTableData,\n    greenPaletteColorLookupTableData: imagePixelModule.greenPaletteColorLookupTableData,\n    bluePaletteColorLookupTableData: imagePixelModule.bluePaletteColorLookupTableData,\n    pixelData: undefined // populated later after decoding\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/getImageFrame.js","/**\n * Calculate the minimum and maximum pixel values in the input\n * pixel data array\n *\n * @param storedPixelData\n * @return {{min: Number, max: Number}} Minimum and maximum values in the input array\n */\nexport default function (storedPixelData) {\n  let min = storedPixelData[0];\n  let max = storedPixelData[0];\n  const numPixels = storedPixelData.length;\n\n  for (let index = 0; index < numPixels; index++) {\n    const storedPixel = storedPixelData[index];\n\n    min = Math.min(min, storedPixel);\n    max = Math.max(max, storedPixel);\n  }\n\n  return {\n    min,\n    max\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/getMinMax.js","/**\n * Check whether the photometric interpretation value for an image\n * represents a color image.\n *\n * @param {String} photometricInterpretation The Photometric Interpretation value\n * @return {boolean} Whether or not this is a color data type\n */\nexport default function (photometricInterpretation) {\n  return (photometricInterpretation === 'RGB' ||\n    photometricInterpretation === 'PALETTE COLOR' ||\n    photometricInterpretation === 'YBR_FULL' ||\n    photometricInterpretation === 'YBR_FULL_422' ||\n    photometricInterpretation === 'YBR_PARTIAL_422' ||\n    photometricInterpretation === 'YBR_PARTIAL_420' ||\n    photometricInterpretation === 'YBR_RCT' ||\n    photometricInterpretation === 'YBR_ICT');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/isColorImage.js","/**\n * Check if an image is an 8-bit JPEGBaseline color image\n *\n * @param {Object} imageFrame\n * @param {String} transferSyntax The image's transfer syntax\n * @return {boolean} Whether or not the image is a 8-bit JPEGBaseline color image\n */\nexport default function (imageFrame, transferSyntax) {\n  transferSyntax = transferSyntax || imageFrame.transferSyntax;\n\n  return (imageFrame.bitsAllocated === 8 &&\n     transferSyntax === '1.2.840.10008.1.2.4.50' &&\n     (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/isJPEGBaseline8BitColor.js","import $ from 'jquery';\nimport { getOptions } from './internal/options';\n\n// the taskId to assign to the next task added via addTask()\nlet nextTaskId = 0;\n\n// array of queued tasks sorted with highest priority task first\nconst tasks = [];\n\n// array of web workers to dispatch decode tasks to\nconst webWorkers = [];\n\n// The options for CornerstoneWADOImageLoader\nconst options = getOptions();\n\nconst defaultConfig = {\n  maxWebWorkers: navigator.hardwareConcurrency || 1,\n  startWebWorkersOnDemand: true,\n  webWorkerPath: '../../dist/cornerstoneWADOImageLoaderWebWorker.js',\n  webWorkerTaskPaths: [],\n  taskConfiguration: {\n    decodeTask: {\n      loadCodecsOnStartup: true,\n      initializeCodecsOnStartup: false,\n      codecsPath: '../dist/cornerstoneWADOImageLoaderCodecs.js',\n      usePDFJS: false,\n      strict: options.strict\n    }\n  }\n};\n\nlet config;\n\nconst statistics = {\n  maxWebWorkers: 0,\n  numWebWorkers: 0,\n  numTasksQueued: 0,\n  numTasksExecuting: 0,\n  numTasksCompleted: 0,\n  totalTaskTimeInMS: 0,\n  totalTimeDelayedInMS: 0\n};\n\n/**\n * Function to start a task on a web worker\n */\nfunction startTaskOnWebWorker () {\n  // return immediately if no decode tasks to do\n  if (!tasks.length) {\n    return;\n  }\n\n  // look for a web worker that is ready\n  for (let i = 0; i < webWorkers.length; i++) {\n    if (webWorkers[i].status === 'ready') {\n      // mark it as busy so tasks are not assigned to it\n      webWorkers[i].status = 'busy';\n\n      // get the highest priority task\n      const task = tasks.shift();\n\n      task.start = new Date().getTime();\n\n      // update stats with how long this task was delayed (waiting in queue)\n      const end = new Date().getTime();\n\n      statistics.totalTimeDelayedInMS += end - task.added;\n\n      // assign this task to this web worker and send the web worker\n      // a message to execute it\n      webWorkers[i].task = task;\n      webWorkers[i].worker.postMessage({\n        taskType: task.taskType,\n        workerIndex: i,\n        data: task.data\n      }, task.transferList);\n      statistics.numTasksExecuting++;\n\n      return;\n    }\n  }\n\n  // if no available web workers and we haven't started max web workers, start a new one\n  if (webWorkers.length < config.maxWebWorkers) {\n    spawnWebWorker();\n  }\n}\n\n/**\n * Function to handle a message from a web worker\n * @param msg\n */\nfunction handleMessageFromWorker (msg) {\n  // console.log('handleMessageFromWorker', msg.data);\n  if (msg.data.taskType === 'initialize') {\n    webWorkers[msg.data.workerIndex].status = 'ready';\n    startTaskOnWebWorker();\n  } else {\n    const start = webWorkers[msg.data.workerIndex].task.start;\n\n    webWorkers[msg.data.workerIndex].task.deferred.resolve(msg.data.result);\n    webWorkers[msg.data.workerIndex].task = undefined;\n\n    statistics.numTasksExecuting--;\n    webWorkers[msg.data.workerIndex].status = 'ready';\n    statistics.numTasksCompleted++;\n\n    const end = new Date().getTime();\n\n    statistics.totalTaskTimeInMS += end - start;\n\n    startTaskOnWebWorker();\n  }\n}\n\n/**\n * Spawns a new web worker\n */\nfunction spawnWebWorker () {\n  // prevent exceeding maxWebWorkers\n  if (webWorkers.length >= config.maxWebWorkers) {\n    return;\n  }\n\n  // spawn the webworker\n  const worker = new Worker(config.webWorkerPath);\n\n  webWorkers.push({\n    worker,\n    status: 'initializing'\n  });\n  worker.addEventListener('message', handleMessageFromWorker);\n  worker.postMessage({\n    taskType: 'initialize',\n    workerIndex: webWorkers.length - 1,\n    config\n  });\n}\n\n/**\n * Initialization function for the web worker manager - spawns web workers\n * @param configObject\n */\nfunction initialize (configObject) {\n  configObject = configObject || defaultConfig;\n\n  // prevent being initialized more than once\n  if (config) {\n    throw new Error('WebWorkerManager already initialized');\n  }\n\n  config = configObject;\n\n  config.maxWebWorkers = config.maxWebWorkers || (navigator.hardwareConcurrency || 1);\n\n  // Spawn new web workers\n  if (!config.startWebWorkersOnDemand) {\n    for (let i = 0; i < config.maxWebWorkers; i++) {\n      spawnWebWorker();\n    }\n  }\n}\n\n/**\n * dynamically loads a web worker task\n * @param sourcePath\n * @param taskConfig\n */\nfunction loadWebWorkerTask (sourcePath, taskConfig) {\n  // add it to the list of web worker tasks paths so on demand web workers\n  // load this properly\n  config.webWorkerTaskPaths.push(sourcePath);\n\n  // if a task specific configuration is provided, merge it into the config\n  if (taskConfig) {\n    config.taskConfiguration = Object.assign(config.taskConfiguration, taskConfig);\n  }\n\n  // tell each spawned web worker to load this task\n  for (let i = 0; i < webWorkers.length; i++) {\n    webWorkers[i].worker.postMessage({\n      taskType: 'loadWebWorkerTask',\n      workerIndex: webWorkers.length - 1,\n      sourcePath,\n      config\n    });\n  }\n}\n\n/**\n * Function to add a decode task to be performed\n *\n * @param taskType - the taskType for this task\n * @param data - data specific to the task\n * @param priority - optional priority of the task (defaults to 0), > 0 is higher, < 0 is lower\n * @param transferList - optional array of data to transfer to web worker\n *\n * @returns {Object}\n */\nfunction addTask (taskType, data, priority = 0, transferList) {\n  if (!config) {\n    initialize();\n  }\n\n  const deferred = $.Deferred();\n\n  // find the right spot to insert this decode task (based on priority)\n  let i;\n\n  for (i = 0; i < tasks.length; i++) {\n    if (tasks[i].priority <= priority) {\n      break;\n    }\n  }\n\n  const taskId = nextTaskId++;\n\n  // insert the decode task at position i\n  tasks.splice(i, 0, {\n    taskId,\n    taskType,\n    status: 'ready',\n    added: new Date().getTime(),\n    data,\n    deferred,\n    priority,\n    transferList\n  });\n\n  // try to start a task on the web worker since we just added a new task and a web worker may be available\n  startTaskOnWebWorker();\n\n  return {\n    taskId,\n    promise: deferred.promise()\n  };\n}\n\n/**\n * Changes the priority of a queued task\n * @param taskId - the taskId to change the priority of\n * @param priority - priority of the task (defaults to 0), > 0 is higher, < 0 is lower\n * @returns boolean - true on success, false if taskId not found\n */\nfunction setTaskPriority (taskId, priority = 0) {\n  // search for this taskId\n  for (let i = 0; i < tasks.length; i++) {\n    if (tasks[i].taskId === taskId) {\n      // taskId found, remove it\n      const task = tasks.splice(i, 1)[0];\n\n      // set its priority\n      task.priority = priority;\n\n      // find the right spot to insert this decode task (based on priority)\n      for (i = 0; i < tasks.length; i++) {\n        if (tasks[i].priority <= priority) {\n          break;\n        }\n      }\n\n      // insert the decode task at position i\n      tasks.splice(i, 0, task);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Cancels a queued task and rejects\n * @param taskId - the taskId to cancel\n * @param reason - optional reason the task was rejected\n * @returns boolean - true on success, false if taskId not found\n */\nfunction cancelTask (taskId, reason) {\n  // search for this taskId\n  for (let i = 0; i < tasks.length; i++) {\n    if (tasks[i].taskId === taskId) {\n      // taskId found, remove it\n      const task = tasks.splice(i, 1);\n\n      task.promise.reject(reason);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Function to return the statistics on running web workers\n * @returns object containing statistics\n */\nfunction getStatistics () {\n  statistics.maxWebWorkers = config.maxWebWorkers;\n  statistics.numWebWorkers = webWorkers.length;\n  statistics.numTasksQueued = tasks.length;\n\n  return statistics;\n}\n\nexport default {\n  initialize,\n  loadWebWorkerTask,\n  addTask,\n  getStatistics,\n  setTaskPriority,\n  cancelTask\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/webWorkerManager.js","import stringToUint8Array from './stringToUint8Array';\n\n/**\n * checkToken\n *\n * @param token\n * @param data\n * @param dataOffset\n * @return {boolean}\n */\nfunction checkToken (token, data, dataOffset) {\n  if (dataOffset + token.length > data.length) {\n    return false;\n  }\n\n  let endIndex = dataOffset;\n\n  for (let i = 0; i < token.length; i++) {\n    if (token[i] !== data[endIndex++]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n *\n * @param data\n * @param str\n * @param offset\n * @return {*}\n */\nexport default function findIndexOfString (data, str, offset) {\n\n  offset = offset || 0;\n\n  const token = stringToUint8Array(str);\n\n  for (let i = offset; i < data.length; i++) {\n    if (token[0] === data[i]) {\n      // console.log('match @', i);\n      if (checkToken(token, data, i)) {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/findIndexOfString.js","import $ from 'jquery';\nimport { xhrRequest } from '../internal';\nimport findIndexOfString from './findIndexOfString';\nimport uint8ArrayToString from './uint8ArrayToString';\n\n/**\n *\n * @param header\n * @return {*}\n */\nfunction findBoundary (header) {\n  for (let i = 0; i < header.length; i++) {\n    if (header[i].substr(0, 2) === '--') {\n      return header[i];\n    }\n  }\n}\n\n/**\n *\n * @param header\n * @return {String|Undefined}\n */\nfunction findContentType (header) {\n  for (let i = 0; i < header.length; i++) {\n    if (header[i].substr(0, 13) === 'Content-Type:') {\n      return header[i].substr(13).trim();\n    }\n  }\n}\n\n/**\n *\n * @param {String} uri\n * @param {String} imageId\n * @param {String} mediaType\n * @returns {Promise}\n */\nexport default function (uri, imageId, mediaType) {\n  mediaType = mediaType || 'application/octet-stream';\n  const headers = {\n    accept: mediaType\n  };\n\n  const deferred = $.Deferred();\n\n  const loadPromise = xhrRequest(uri, imageId, headers);\n\n  loadPromise.then(function (imageFrameAsArrayBuffer/* , xhr*/) {\n\n    // request succeeded, Parse the multi-part mime response\n    const response = new Uint8Array(imageFrameAsArrayBuffer);\n\n    // First look for the multipart mime header\n    const tokenIndex = findIndexOfString(response, '\\r\\n\\r\\n');\n\n    if (tokenIndex === -1) {\n      deferred.reject('invalid response - no multipart mime header');\n    }\n    const header = uint8ArrayToString(response, 0, tokenIndex);\n\n    // Now find the boundary marker\n    const split = header.split('\\r\\n');\n    const boundary = findBoundary(split);\n\n    if (!boundary) {\n      deferred.reject('invalid response - no boundary marker');\n    }\n    const offset = tokenIndex + 4; // skip over the \\r\\n\\r\\n\n\n    // find the terminal boundary marker\n    const endIndex = findIndexOfString(response, boundary, offset);\n\n    if (endIndex === -1) {\n      deferred.reject('invalid response - terminating boundary not found');\n    }\n\n    // Remove \\r\\n from the length\n    const length = endIndex - offset - 2;\n\n    // return the info for this pixel data\n    deferred.resolve({\n      contentType: findContentType(split),\n      imageFrame: {\n        pixelData: new Uint8Array(imageFrameAsArrayBuffer, offset, length)\n      }\n    });\n  });\n\n  return deferred.promise();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/getPixelData.js","import getValue from './getValue';\n\n/**\n *\n * @param element\n * @param {Number} index\n * @return {Number|Undefined}\n */\nexport default function (element, index) {\n  const value = getValue(element, index);\n\n  if (value === undefined) {\n    return;\n  }\n\n  return parseFloat(value);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberValue.js","/**\n * Returns the values as an array of numbers\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param {Number} [minimumLength] - the minimum number of values\n * @returns {Array|Undefined}\n */\nexport default function (element, minimumLength) {\n  if (!element) {\n    return;\n  }\n  // Value is not present if the attribute has a zero length value\n  if (!element.Value) {\n    return;\n  }\n  // make sure we have the expected length\n  if (minimumLength && element.Value.length < minimumLength) {\n    return;\n  }\n\n  const values = [];\n\n  for (let i = 0; i < element.Value.length; i++) {\n    values.push(parseFloat(element.Value[i]));\n  }\n\n  return values;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberValues.js","let files = [];\n\n/**\n * Adds a file to the file manager\n *\n * @param file\n * @return {string} An imageId for the added file\n */\nfunction add (file) {\n  const fileIndex = files.push(file);\n\n  return `dicomfile:${fileIndex - 1}`;\n}\n\n/**\n * Retrieve the file at a specific index in the fileManager\n *\n * @param {Number} index\n * @return {*}\n */\nfunction get (index) {\n  return files[index];\n}\n\n/**\n * Remove the file at a specific index in the fileManager\n *\n * @param {Number} index\n */\nfunction remove (index) {\n  files[index] = undefined;\n}\n\n/**\n * Erase all files stored in the file manager\n */\nfunction purge () {\n  files = [];\n}\n\nexport default {\n  add,\n  get,\n  remove,\n  purge\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/fileManager.js","import * as dicomParser from 'dicom-parser';\n\n/**\n *\n * @param dataSet\n * @return {boolean} Whether or not the frames are fragmented\n */\nfunction framesAreFragmented (dataSet) {\n  const numberOfFrames = dataSet.intString('x00280008');\n  const pixelDataElement = dataSet.elements.x7fe00010;\n\n  return (numberOfFrames !== pixelDataElement.fragments.length);\n}\n\n/**\n * Function to deal with extracting an image frame from an encapsulated data set.\n *\n * @param dataSet\n * @param frameIndex\n * @return {*}\n */\nexport default function getEncapsulatedImageFrame (dataSet, frameIndex) {\n  if (dataSet.elements.x7fe00010.basicOffsetTable.length) {\n    // Basic Offset Table is not empty\n    return dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex);\n  }\n\n  // Empty basic offset table\n  if (framesAreFragmented(dataSet)) {\n    const basicOffsetTable = dicomParser.createJPEGBasicOffsetTable(dataSet, dataSet.elements.x7fe00010);\n\n    return dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex, basicOffsetTable);\n  }\n\n  return dicomParser.readEncapsulatedPixelDataFromFragments(dataSet, dataSet.elements.x7fe00010, frameIndex);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getEncapsulatedImageFrame.js","import unpackBinaryFrame from './unpackBinaryFrame';\n\n/**\n * Function to deal with extracting an image frame from an encapsulated data set.\n *\n * @param {DataSet} dataSet\n * @param {Number} frameIndex\n * @return {*}\n * @throws If the specified frameIndex is outside the byte array\n */\nexport default function (dataSet, frameIndex) {\n  const pixelDataElement = dataSet.elements.x7fe00010;\n  const bitsAllocated = dataSet.uint16('x00280100');\n  const rows = dataSet.uint16('x00280010');\n  const columns = dataSet.uint16('x00280011');\n  const samplesPerPixel = dataSet.uint16('x00280002');\n\n  const pixelDataOffset = pixelDataElement.dataOffset;\n  const pixelsPerFrame = rows * columns * samplesPerPixel;\n\n  let frameOffset;\n\n  if (bitsAllocated === 8) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame);\n  } else if (bitsAllocated === 16) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 2;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame * 2);\n  } else if (bitsAllocated === 1) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 0.125;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return unpackBinaryFrame(dataSet.byteArray, frameOffset, pixelsPerFrame);\n  }\n\n  throw new Error('unsupported pixel format');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getUncompressedImageFrame.js","import $ from 'jquery';\nimport parseImageId from './parseImageId';\nimport fileManager from './fileManager';\n\n/**\n * Loads a file using the browser(?)\n *\n * @param uri\n * @returns {Promise}\n */\nexport default function (uri) {\n  const parsedImageId = parseImageId(uri);\n  const fileIndex = parseInt(parsedImageId.url, 10);\n  const file = fileManager.get(fileIndex);\n  const deferred = $.Deferred();\n  const fileReader = new FileReader();\n\n  fileReader.onload = function (e) {\n    const dicomPart10AsArrayBuffer = e.target.result;\n\n    deferred.resolve(dicomPart10AsArrayBuffer);\n  };\n\n  fileReader.readAsArrayBuffer(file);\n\n  return deferred.promise();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/loadFileRequest.js","\n\nfunction getLutDescriptor (dataSet, tag) {\n  if (!dataSet.elements[tag] || dataSet.elements[tag].length !== 6) {\n    return;\n  }\n\n  return [dataSet.uint16(tag, 0), dataSet.uint16(tag, 1), dataSet.uint16(tag, 2)];\n}\n\nfunction getLutData (lutDataSet, tag, lutDescriptor) {\n  const lut = [];\n  const lutData = lutDataSet.elements[tag];\n  const numLutEntries = lutDescriptor[0];\n\n  for (let i = 0; i < numLutEntries; i++) {\n    // Output range is always unsigned\n    if (lutDescriptor[2] === 16) {\n      lut[i] = lutDataSet.uint16(tag, i);\n    } else {\n      lut[i] = lutDataSet.byteArray[i + lutData.dataOffset];\n    }\n  }\n\n  return lut;\n}\n\nfunction populatePaletteColorLut (dataSet, imagePixelModule) {\n  // return immediately if photometric interpretation is not PALETTE COLOR or no palette lut elements\n  if (imagePixelModule.photometricInterpretation !== 'PALETTE COLOR' || !dataSet.elements.x00281101) {\n    return;\n  }\n  imagePixelModule.redPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281101');\n  imagePixelModule.greenPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281102');\n  imagePixelModule.bluePaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281103');\n\n  imagePixelModule.redPaletteColorLookupTableData = getLutData(dataSet, 'x00281201', imagePixelModule.redPaletteColorLookupTableDescriptor);\n  imagePixelModule.greenPaletteColorLookupTableData = getLutData(dataSet, 'x00281202', imagePixelModule.greenPaletteColorLookupTableDescriptor);\n  imagePixelModule.bluePaletteColorLookupTableData = getLutData(dataSet, 'x00281203', imagePixelModule.bluePaletteColorLookupTableDescriptor);\n}\n\nfunction populateSmallestLargestPixelValues (dataSet, imagePixelModule) {\n  const pixelRepresentation = dataSet.uint16('x00280103');\n\n  if (pixelRepresentation === 0) {\n    imagePixelModule.smallestPixelValue = dataSet.uint16('x00280106');\n    imagePixelModule.largestPixelValue = dataSet.uint16('x00280107');\n  } else {\n    imagePixelModule.smallestPixelValue = dataSet.int16('x00280106');\n    imagePixelModule.largestPixelValue = dataSet.int16('x00280107');\n  }\n}\n\nfunction getImagePixelModule (dataSet) {\n\n  const imagePixelModule = {\n    samplesPerPixel: dataSet.uint16('x00280002'),\n    photometricInterpretation: dataSet.string('x00280004'),\n    rows: dataSet.uint16('x00280010'),\n    columns: dataSet.uint16('x00280011'),\n    bitsAllocated: dataSet.uint16('x00280100'),\n    bitsStored: dataSet.uint16('x00280101'),\n    highBit: dataSet.uint16('x00280102'),\n    pixelRepresentation: dataSet.uint16('x00280103'),\n    planarConfiguration: dataSet.uint16('x00280006'),\n    pixelAspectRatio: dataSet.string('x00280034')\n  };\n\n  populateSmallestLargestPixelValues(dataSet, imagePixelModule);\n  populatePaletteColorLut(dataSet, imagePixelModule);\n\n  return imagePixelModule;\n\n}\n\nexport default getImagePixelModule;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getImagePixelModule.js","\n\nfunction getLUT (pixelRepresentation, lutDataSet) {\n  let numLUTEntries = lutDataSet.uint16('x00283002', 0);\n\n  if (numLUTEntries === 0) {\n    numLUTEntries = 65535;\n  }\n  let firstValueMapped = 0;\n\n  if (pixelRepresentation === 0) {\n    firstValueMapped = lutDataSet.uint16('x00283002', 1);\n  } else {\n    firstValueMapped = lutDataSet.int16('x00283002', 1);\n  }\n  const numBitsPerEntry = lutDataSet.uint16('x00283002', 2);\n  // console.log('LUT(', numLUTEntries, ',', firstValueMapped, ',', numBitsPerEntry, ')');\n  const lut = {\n    id: '1',\n    firstValueMapped,\n    numBitsPerEntry,\n    lut: []\n  };\n\n  // console.log(\"minValue=\", minValue, \"; maxValue=\", maxValue);\n  for (let i = 0; i < numLUTEntries; i++) {\n    if (pixelRepresentation === 0) {\n      lut.lut[i] = lutDataSet.uint16('x00283006', i);\n    } else {\n      lut.lut[i] = lutDataSet.int16('x00283006', i);\n    }\n  }\n\n  return lut;\n}\n\n\nfunction getLUTs (pixelRepresentation, lutSequence) {\n  if (!lutSequence || !lutSequence.items.length) {\n    return;\n  }\n  const luts = [];\n\n  for (let i = 0; i < lutSequence.items.length; i++) {\n    const lutDataSet = lutSequence.items[i].dataSet;\n    const lut = getLUT(pixelRepresentation, lutDataSet);\n\n    if (lut) {\n      luts.push(lut);\n    }\n  }\n\n  return luts;\n}\n\nexport default getLUTs;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getLUTs.js","/* eslint no-bitwise: 0 */\n\nfunction getMinStoredPixelValue (dataSet) {\n  const pixelRepresentation = dataSet.uint16('x00280103');\n  const bitsStored = dataSet.uint16('x00280101');\n\n  if (pixelRepresentation === 0) {\n    return 0;\n  }\n\n  return -1 << (bitsStored - 1);\n}\n\n// 0 = unsigned / US, 1 = signed / SS\nfunction getModalityLUTOutputPixelRepresentation (dataSet) {\n\n  // CT SOP Classes are always signed\n  const sopClassUID = dataSet.string('x00080016');\n\n  if (sopClassUID === '1.2.840.10008.5.1.4.1.1.2' ||\n    sopClassUID === '1.2.840.10008.5.1.4.1.1.2.1') {\n    return 1;\n  }\n\n  // if rescale intercept and rescale slope are present, pass the minimum stored\n  // pixel value through them to see if we get a signed output range\n  const rescaleIntercept = dataSet.floatString('x00281052');\n  const rescaleSlope = dataSet.floatString('x00281053');\n\n  if (rescaleIntercept !== undefined && rescaleSlope !== undefined) {\n    const minStoredPixelValue = getMinStoredPixelValue(dataSet); //\n    const minModalityLutValue = minStoredPixelValue * rescaleSlope + rescaleIntercept;\n\n    if (minModalityLutValue < 0) {\n      return 1;\n    }\n\n    return 0;\n\n  }\n\n  // Output of non linear modality lut is always unsigned\n  if (dataSet.elements.x00283000 && dataSet.elements.x00283000.length > 0) {\n    return 0;\n  }\n\n  // If no modality lut transform, output is same as pixel representation\n  return dataSet.uint16('x00280103');\n}\n\nexport default getModalityLUTOutputPixelRepresentation;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js","function getNumberValues (dataSet, tag, minimumLength) {\n  const values = [];\n  const valueAsString = dataSet.string(tag);\n\n  if (!valueAsString) {\n    return;\n  }\n  const split = valueAsString.split('\\\\');\n\n  if (minimumLength && split.length < minimumLength) {\n    return;\n  }\n  for (let i = 0; i < split.length; i++) {\n    values.push(parseFloat(split[i]));\n  }\n\n  return values;\n}\n\nexport default getNumberValues;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getNumberValues.js","/* eslint no-bitwise: 0 */\n\n/**\n * Check whether a bit position is set inside a byte\n *\n * @param {Number} byte The input byte\n * @param {Number} bitPos The bit position\n * @return {Boolean} Whether or not the bit is set\n */\nfunction isBitSet (byte, bitPos) {\n  return Boolean(byte & (1 << bitPos));\n}\n\n/**\n * Function to deal with unpacking a binary frame\n *\n * @param byteArray\n * @param {Number} frameOffset\n * @param pixelsPerFrame\n *\n * @return {Uint8Array}\n */\nexport default function (byteArray, frameOffset, pixelsPerFrame) {\n  // Create a new pixel array given the image size\n  const pixelData = new Uint8Array(pixelsPerFrame);\n\n  for (let i = 0; i < pixelsPerFrame; i++) {\n    // Compute byte position\n    const bytePos = Math.floor(i / 8);\n\n    // Get the current byte\n    const byte = byteArray[bytePos + frameOffset];\n\n    // Bit position (0-7) within byte\n    const bitPos = (i % 8);\n\n    // Check whether bit at bitpos is set\n    pixelData[i] = isBitSet(byte, bitPos) ? 1 : 0;\n  }\n\n  return pixelData;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/unpackBinaryFrame.js","import { setOptions } from './internal';\n\n/**\n * Configures CornerstoneWADOImageLoader with the supplied options.\n * Note: Overwrites all currently set options.\n *\n * @param {Object} options\n */\nexport default function (options) {\n  setOptions(options);\n}\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/configure.js","import { getNumberString,\n         getNumberValue,\n         getNumberValues,\n         getValue,\n         metaDataProvider } from './metaData';\n\nimport findIndexOfString from './findIndexOfString';\nimport getPixelData from './getPixelData';\nimport metaDataManager from './metaDataManager';\nimport loadImage from './loadImage';\n\nconst metaData = {\n  getNumberString,\n  getNumberValue,\n  getNumberValues,\n  getValue,\n  metaDataProvider\n};\n\nexport default {\n  metaData,\n  findIndexOfString,\n  getPixelData,\n  loadImage,\n  metaDataManager\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/index.js","import { getImagePixelModule,\n         getLUTs,\n         getModalityLUTOutputPixelRepresentation,\n         getNumberValues,\n         metaDataProvider } from './metaData';\n\nimport dataSetCacheManager from './dataSetCacheManager';\nimport fileManager from './fileManager';\nimport getEncapsulatedImageFrame from './getEncapsulatedImageFrame';\nimport getUncompressedImageFrame from './getUncompressedImageFrame';\nimport loadFileRequest from './loadFileRequest';\nimport { loadImageFromPromise,\n         getLoaderForScheme,\n         loadImage } from './loadImage';\n\nimport parseImageId from './parseImageId';\nimport unpackBinaryFrame from './unpackBinaryFrame';\n\nconst metaData = {\n  getImagePixelModule,\n  getLUTs,\n  getModalityLUTOutputPixelRepresentation,\n  getNumberValues,\n  metaDataProvider\n};\n\nexport default {\n  metaData,\n  dataSetCacheManager,\n  fileManager,\n  getEncapsulatedImageFrame,\n  getUncompressedImageFrame,\n  loadFileRequest,\n  loadImageFromPromise,\n  getLoaderForScheme,\n  loadImage,\n  parseImageId,\n  unpackBinaryFrame\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/index.js","/* eslint no-bitwise: 0 */\n\nexport default function (imageFrame, rgbaBuffer) {\n  const numPixels = imageFrame.columns * imageFrame.rows;\n  let palIndex = 0;\n  let rgbaIndex = 0;\n  const pixelData = imageFrame.pixelData;\n  const start = imageFrame.redPaletteColorLookupTableDescriptor[1];\n  const rData = imageFrame.redPaletteColorLookupTableData;\n  const gData = imageFrame.greenPaletteColorLookupTableData;\n  const bData = imageFrame.bluePaletteColorLookupTableData;\n  const shift = imageFrame.redPaletteColorLookupTableDescriptor[2] === 8 ? 0 : 8;\n  let len = imageFrame.redPaletteColorLookupTableData.length;\n\n  if (len === 0) {\n    len = 65535;\n  }\n\n  for (let i = 0; i < numPixels; ++i) {\n    let value = pixelData[palIndex++];\n\n    if (value < start) {\n      value = 0;\n    } else if (value > start + len - 1) {\n      value = len - 1;\n    } else {\n      value -= start;\n    }\n\n    rgbaBuffer[rgbaIndex++] = rData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = gData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = bData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = 255;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let rgbIndex = 0;\n  let rgbaIndex = 0;\n\n  for (let i = 0; i < numPixels; i++) {\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // red\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // green\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let rgbaIndex = 0;\n  let rIndex = 0;\n  let gIndex = numPixels;\n  let bIndex = numPixels * 2;\n\n  for (let i = 0; i < numPixels; i++) {\n    rgbaBuffer[rgbaIndex++] = imageFrame[rIndex++]; // red\n    rgbaBuffer[rgbaIndex++] = imageFrame[gIndex++]; // green\n    rgbaBuffer[rgbaIndex++] = imageFrame[bIndex++]; // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let ybrIndex = 0;\n  let rgbaIndex = 0;\n\n  for (let i = 0; i < numPixels; i++) {\n    const y = imageFrame[ybrIndex++];\n    const cb = imageFrame[ybrIndex++];\n    const cr = imageFrame[ybrIndex++];\n\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128);// red\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let rgbaIndex = 0;\n  let yIndex = 0;\n  let cbIndex = numPixels;\n  let crIndex = numPixels * 2;\n\n  for (let i = 0; i < numPixels; i++) {\n    const y = imageFrame[yIndex++];\n    const cb = imageFrame[cbIndex++];\n    const cr = imageFrame[crIndex++];\n\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128);// red\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js","export * from './colorSpaceConverters';\n\nexport { default as wadouri } from './wadouri';\nexport { default as wadors } from './wadors';\nexport { default as configure } from './configure';\nexport { default as convertColorSpace } from './convertColorSpace';\nexport { default as createImage } from './createImage';\nexport { default as decodeImageFrame } from './decodeImageFrame';\nexport { default as decodeJPEGBaseline8BitColor } from './decodeJPEGBaseline8BitColor';\nexport { default as getImageFrame } from './getImageFrame';\nexport { default as getMinMax } from './getMinMax';\nexport { default as isColorImage } from './isColorImage';\nexport { default as isJPEGBaseline8BitColor } from './isJPEGBaseline8BitColor';\nexport { default as webWorkerManager } from './webWorkerManager';\nexport { default as version } from '../version';\nexport { internal } from './internal/';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/index.js","import $ from 'jquery';\nimport { getOptions } from './options';\nimport * as cornerstone from 'cornerstone-core';\n\nfunction xhrRequest (url, imageId, headers = {}) {\n  const deferred = $.Deferred();\n  const options = getOptions();\n\n  // Make the request for the DICOM P10 SOP Instance\n  const xhr = new XMLHttpRequest();\n\n  xhr.open('get', url, true);\n  xhr.responseType = 'arraybuffer';\n  options.beforeSend(xhr);\n  Object.keys(headers).forEach(function (key) {\n    xhr.setRequestHeader(key, headers[key]);\n  });\n\n  // handle response data\n  xhr.onreadystatechange = function () {\n    // TODO: consider sending out progress messages here as we receive the pixel data\n    if (xhr.readyState === 4) {\n      if (xhr.status === 200) {\n        deferred.resolve(xhr.response, xhr);\n      } else {\n        // request failed, reject the deferred\n        deferred.reject(xhr);\n      }\n    }\n  };\n  xhr.onprogress = function (oProgress) {\n    // console.log('progress:',oProgress)\n\n    if (oProgress.lengthComputable) {  // evt.loaded the bytes browser receive\n      // evt.total the total bytes seted by the header\n      //\n      const loaded = oProgress.loaded;\n      const total = oProgress.total;\n      const percentComplete = Math.round((loaded / total) * 100);\n\n      $(cornerstone.events).trigger('CornerstoneImageLoadProgress', {\n        imageId,\n        loaded,\n        total,\n        percentComplete\n      });\n    }\n  };\n\n  xhr.send();\n\n  return deferred.promise();\n}\n\nexport default xhrRequest;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/xhrRequest.js","import $ from 'jquery';\nimport * as cornerstone from 'cornerstone-core';\nimport metaDataManager from './metaDataManager';\nimport getPixelData from './getPixelData';\nimport createImage from '../createImage';\n\nfunction getTransferSyntaxForContentType (/* contentType */) {\n  return '1.2.840.10008.1.2'; // hard code to ILE for now\n}\n\n/**\n *\n * @param {string} imageId\n * @param {Object} options\n * @returns {Deferred}\n */\nexport default function loadImage (imageId, options) {\n  const start = new Date().getTime();\n\n  const deferred = $.Deferred();\n\n  const uri = imageId.substring(7);\n\n  // check to make sure we have metadata for this imageId\n  const metaData = metaDataManager.get(imageId);\n\n  if (metaData === undefined) {\n    deferred.reject(`no metadata for imageId ${imageId}`);\n\n    return deferred.promise();\n  }\n\n  // TODO: load bulk data items that we might need\n\n  const mediaType = 'multipart/related; type=\"application/octet-stream\"'; // 'image/dicom+jp2';\n\n  // get the pixel data from the server\n  getPixelData(uri, imageId, mediaType).then(function (result) {\n\n    const transferSyntax = getTransferSyntaxForContentType(result.contentType);\n    const pixelData = result.imageFrame.pixelData;\n    const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\n\n    imagePromise.then(function (image) {\n      // add the loadTimeInMS property\n      const end = new Date().getTime();\n\n      image.loadTimeInMS = end - start;\n      deferred.resolve(image);\n    });\n  }).fail(function (reason) {\n    deferred.reject(reason);\n  });\n\n  return deferred;\n}\n\n// register wadors scheme\ncornerstone.registerImageLoader('wadors', loadImage);\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/loadImage.js","import getValue from './getValue';\n\n/**\n * Returns the first string value as a Javascript number\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param {Number} [index] - the index of the value in a multi-valued element, default is 0\n * @param {*} [defaultValue] - The default value to return if the element does not exist\n * @returns {Number|Undefined}\n */\nexport default function (element, index, defaultValue) {\n  const value = getValue(element, index, defaultValue);\n\n  if (value === undefined) {\n    return;\n  }\n\n  return parseFloat(value);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberString.js","export { default as getNumberString } from './getNumberString';\nexport { default as getNumberValue } from './getNumberValue';\nexport { default as getNumberValues } from './getNumberValues';\nexport { default as getValue } from './getValue';\nexport { default as metaDataProvider } from './metaDataProvider';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/index.js","import getNumberValues from './getNumberValues';\nimport getValue from './getValue';\nimport getNumberValue from './getNumberValue';\nimport metaDataManager from '../metaDataManager';\nimport * as dicomParser from 'dicom-parser';\nimport * as cornerstone from 'cornerstone-core';\n\nfunction metaDataProvider (type, imageId) {\n  const metaData = metaDataManager.get(imageId);\n\n  if (!metaData) {\n    return;\n  }\n\n  if (type === 'generalSeriesModule') {\n    return {\n      modality: getValue(metaData['00080060']),\n      seriesInstanceUID: getValue(metaData['0020000e']),\n      seriesNumber: getNumberValue(metaData['00200011']),\n      studyInstanceUID: getValue(metaData['0020000d']),\n      seriesDate: dicomParser.parseDA(getValue(metaData['00080021'])),\n      seriesTime: dicomParser.parseTM(getValue(metaData['00080031'], 0, ''))\n    };\n  }\n\n  if (type === 'patientStudyModule') {\n    return {\n      patientAge: getNumberValue(metaData['00101010']),\n      patientSize: getNumberValue(metaData['00101020']),\n      patientWeight: getNumberValue(metaData['00101030'])\n    };\n  }\n\n  if (type === 'imagePlaneModule') {\n    return {\n      pixelSpacing: getNumberValues(metaData['00280030'], 2),\n      imageOrientationPatient: getNumberValues(metaData['00200037'], 6),\n      imagePositionPatient: getNumberValues(metaData['00200032'], 3),\n      sliceThickness: getNumberValue(metaData['00180050']),\n      sliceLocation: getNumberValue(metaData['00201041'])\n    };\n  }\n\n  if (type === 'imagePixelModule') {\n    return {\n      samplesPerPixel: getNumberValue(metaData['00280002']),\n      photometricInterpretation: getValue(metaData['00280004']),\n      rows: getNumberValue(metaData['00280010']),\n      columns: getNumberValue(metaData['00280011']),\n      bitsAllocated: getNumberValue(metaData['00280100']),\n      bitsStored: getNumberValue(metaData['00280101']),\n      highBit: getValue(metaData['00280102']),\n      pixelRepresentation: getNumberValue(metaData['00280103']),\n      planarConfiguration: getNumberValue(metaData['00280006']),\n      pixelAspectRatio: getValue(metaData['00280034']),\n      smallestPixelValue: getNumberValue(metaData['00280106']),\n      largestPixelValue: getNumberValue(metaData['00280107']),\n      redPaletteColorLookupTableDescriptor: getNumberValues(metaData['00281101']),\n      greenPaletteColorLookupTableDescriptor: getNumberValues(metaData['00281102']),\n      bluePaletteColorLookupTableDescriptor: getNumberValues(metaData['00281103']),\n      redPaletteColorLookupTableData: getNumberValues(metaData['00281201']),\n      greenPaletteColorLookupTableData: getNumberValues(metaData['00281202']),\n      bluePaletteColorLookupTableData: getNumberValues(metaData['00281203'])\n    };\n  }\n\n  if (type === 'voiLutModule') {\n    return {\n      // TODO: VOI LUT Sequence\n      windowCenter: getNumberValues(metaData['00281050'], 1),\n      windowWidth: getNumberValues(metaData['00281051'], 1)\n    };\n  }\n\n  if (type === 'modalityLutModule') {\n    return {\n      rescaleIntercept: getNumberValue(metaData['00281052']),\n      rescaleSlope: getNumberValue(metaData['00281053']),\n      rescaleType: getValue(metaData['00281054'])\n    };\n  }\n\n  if (type === 'sopCommonModule') {\n    return {\n      sopClassUID: getValue(metaData['00080016']),\n      sopInstanceUID: getValue(metaData['00080018'])\n    };\n  }\n\n  if (type === 'petIsotopeModule') {\n    const radiopharmaceuticalInfo = getValue(metaData['00540016']);\n\n    if (radiopharmaceuticalInfo === undefined) {\n      return;\n    }\n\n    return {\n      radiopharmaceuticalInfo: {\n        radiopharmaceuticalStartTime: dicomParser.parseTM(getValue(radiopharmaceuticalInfo['00181072'], 0, '')),\n        radionuclideTotalDose: getNumberValue(radiopharmaceuticalInfo['00181074']),\n        radionuclideHalfLife: getNumberValue(radiopharmaceuticalInfo['00181075'])\n      }\n    };\n  }\n\n}\n\ncornerstone.metaData.addProvider(metaDataProvider);\n\nexport default metaDataProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/metaDataProvider.js","/**\n * Convert a string to a Uint8Array\n *\n * @param {String} str An input string\n * @return {Uint8Array} The string converted to a Uint8Array\n */\nexport default function (str) {\n  const uint = new Uint8Array(str.length);\n\n  for (let i = 0, j = str.length; i < j; i++) {\n    uint[i] = str.charCodeAt(i);\n  }\n\n  return uint;\n}\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/stringToUint8Array.js","/**\n * Convert a Uint8Array to a String\n *\n * @param {Uint8Array} data\n * @param {Number} offset\n * @param {Number} length\n * \n * @return {string} The Uint8Array converted to a String\n */\nexport default function (data, offset, length) {\n  offset = offset || 0;\n  length = length || data.length - offset;\n  let str = '';\n\n  for (let i = offset; i < offset + length; i++) {\n    str += String.fromCharCode(data[i]);\n  }\n\n  return str;\n}\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/uint8ArrayToString.js","import $ from 'jquery';\nimport * as cornerstone from 'cornerstone-core';\nimport createImage from '../createImage';\nimport parseImageId from './parseImageId';\nimport dataSetCacheManager from './dataSetCacheManager';\nimport getEncapsulatedImageFrame from './getEncapsulatedImageFrame';\nimport getUncompressedImageFrame from './getUncompressedImageFrame';\nimport loadFileRequest from './loadFileRequest';\nimport { xhrRequest } from '../internal';\n\n/**\n * Add a decache callback function to clear out our dataSetCacheManager\n *\n * @param {Image} image\n */\nfunction addDecache (image) {\n  image.decache = function () {\n    // console.log('decache');\n    const parsedImageId = parseImageId(image.imageId);\n\n    dataSetCacheManager.unload(parsedImageId.url);\n  };\n}\n\n/**\n *\n * @param {DataSet} dataSet\n * @param {Number} frameIndex\n * @return {*}\n */\nfunction getPixelData (dataSet, frameIndex) {\n  const pixelDataElement = dataSet.elements.x7fe00010;\n\n  if (pixelDataElement.encapsulatedPixelData) {\n    return getEncapsulatedImageFrame(dataSet, frameIndex);\n  }\n\n  return getUncompressedImageFrame(dataSet, frameIndex);\n\n}\n\n/**\n *\n * @param dataSetPromise\n * @param imageId\n * @param frame\n * @param options\n * @return {*}\n */\nfunction loadImageFromPromise (dataSetPromise, imageId, frame, options) {\n\n  const start = new Date().getTime();\n\n  frame = frame || 0;\n  const deferred = $.Deferred();\n\n  dataSetPromise.then(function (dataSet/* , xhr*/) {\n    const pixelData = getPixelData(dataSet, frame);\n    const transferSyntax = dataSet.string('x00020010');\n    const loadEnd = new Date().getTime();\n    const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\n\n    imagePromise.then(function (image) {\n      image.data = dataSet;\n      const end = new Date().getTime();\n\n      image.loadTimeInMS = loadEnd - start;\n      image.totalTimeInMS = end - start;\n      addDecache(image);\n      deferred.resolve(image);\n    });\n  }, function (error) {\n    deferred.reject(error);\n  });\n\n  return deferred;\n}\n\n/**\n *\n * @param {String} scheme\n * @return {*}\n */\nfunction getLoaderForScheme (scheme) {\n  if (scheme === 'dicomweb' || scheme === 'wadouri') {\n    return xhrRequest;\n  } else if (scheme === 'dicomfile') {\n    return loadFileRequest;\n  }\n}\n\n/**\n * Load an imageId\n *\n * @param {String} imageId\n * @param {Object} options\n * @return {*}\n */\nfunction loadImage (imageId, options) {\n  const parsedImageId = parseImageId(imageId);\n  const url = parsedImageId.url;\n  let dataSet;\n\n  // if the dataset for this url is already loaded, use it\n  if (dataSetCacheManager.isLoaded(url)) {\n    dataSet = dataSetCacheManager.get(url);\n\n    return loadImageFromPromise(dataSet, imageId, parsedImageId.frame, options);\n  }\n\n  // load the dataSet via the dataSetCacheManager\n  const loader = getLoaderForScheme(parsedImageId.scheme);\n\n  dataSet = dataSetCacheManager.load(url, loader, imageId);\n\n  return loadImageFromPromise(dataSet, imageId, parsedImageId.frame, options);\n}\n\n// register dicomweb and wadouri image loader prefixes\ncornerstone.registerImageLoader('dicomweb', loadImage);\ncornerstone.registerImageLoader('wadouri', loadImage);\ncornerstone.registerImageLoader('dicomfile', loadImage);\n\nexport { loadImageFromPromise, getLoaderForScheme };\nexport default loadImage;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/loadImage.js","export { default as getImagePixelModule } from './getImagePixelModule';\nexport { default as getLUTs } from './getLUTs';\nexport { default as getModalityLUTOutputPixelRepresentation } from './getModalityLUTOutputPixelRepresentation';\nexport { default as getNumberValues } from './getNumberValues';\nexport { default as metaDataProvider } from './metaDataProvider';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/index.js","import getNumberValues from './getNumberValues';\nimport parseImageId from '../parseImageId';\nimport dataSetCacheManager from '../dataSetCacheManager';\nimport getImagePixelModule from './getImagePixelModule';\nimport getLUTs from './getLUTs';\nimport getModalityLUTOutputPixelRepresentation from './getModalityLUTOutputPixelRepresentation';\nimport * as dicomParser from 'dicom-parser';\nimport * as cornerstone from 'cornerstone-core';\n\nfunction metaDataProvider (type, imageId) {\n  const parsedImageId = parseImageId(imageId);\n\n  if (!dataSetCacheManager.isLoaded(parsedImageId.url)) {\n    return;\n  }\n\n  const dataSet = dataSetCacheManager.get(parsedImageId.url);\n\n  if (type === 'generalSeriesModule') {\n    return {\n      modality: dataSet.string('x00080060'),\n      seriesInstanceUID: dataSet.string('x0020000e'),\n      seriesNumber: dataSet.intString('x00200011'),\n      studyInstanceUID: dataSet.string('x0020000d'),\n      seriesDate: dicomParser.parseDA(dataSet.string('x00080021')),\n      seriesTime: dicomParser.parseTM(dataSet.string('x00080031') || '')\n    };\n  }\n\n  if (type === 'patientStudyModule') {\n    return {\n      patientAge: dataSet.intString('x00101010'),\n      patientSize: dataSet.floatString('x00101020'),\n      patientWeight: dataSet.floatString('x00101030')\n    };\n  }\n\n  if (type === 'imagePlaneModule') {\n    return {\n      pixelSpacing: getNumberValues(dataSet, 'x00280030', 2),\n      imageOrientationPatient: getNumberValues(dataSet, 'x00200037', 6),\n      imagePositionPatient: getNumberValues(dataSet, 'x00200032', 3),\n      sliceThickness: dataSet.floatString('x00180050'),\n      sliceLocation: dataSet.floatString('x00201041'),\n      frameOfReferenceUID: dataSet.string('x00200052')\n    };\n  }\n\n  if (type === 'imagePixelModule') {\n    return getImagePixelModule(dataSet);\n  }\n\n  if (type === 'modalityLutModule') {\n    return {\n      rescaleIntercept: dataSet.floatString('x00281052'),\n      rescaleSlope: dataSet.floatString('x00281053'),\n      rescaleType: dataSet.string('x00281054'),\n      modalityLUTSequence: getLUTs(dataSet.uint16('x00280103'), dataSet.elements.x00283000)\n    };\n  }\n\n  if (type === 'voiLutModule') {\n    const modalityLUTOutputPixelRepresentation = getModalityLUTOutputPixelRepresentation(dataSet);\n\n\n    return {\n      windowCenter: getNumberValues(dataSet, 'x00281050', 1),\n      windowWidth: getNumberValues(dataSet, 'x00281051', 1),\n      voiLUTSequence: getLUTs(modalityLUTOutputPixelRepresentation, dataSet.elements.x00283010)\n    };\n  }\n\n  if (type === 'sopCommonModule') {\n    return {\n      sopClassUID: dataSet.string('x00080016'),\n      sopInstanceUID: dataSet.string('x00080018')\n    };\n  }\n\n  if (type === 'petIsotopeModule') {\n    const radiopharmaceuticalInfo = dataSet.elements.x00540016;\n\n    if (radiopharmaceuticalInfo === undefined) {\n      return;\n    }\n\n    const firstRadiopharmaceuticalInfoDataSet = radiopharmaceuticalInfo.items[0].dataSet;\n\n\n    return {\n      radiopharmaceuticalInfo: {\n        radiopharmaceuticalStartTime: dicomParser.parseTM(firstRadiopharmaceuticalInfoDataSet.string('x00181072') || ''),\n        radionuclideTotalDose: firstRadiopharmaceuticalInfoDataSet.floatString('x00181074'),\n        radionuclideHalfLife: firstRadiopharmaceuticalInfoDataSet.floatString('x00181075')\n      }\n    };\n  }\n\n}\n\n// register our metadata provider\ncornerstone.metaData.addProvider(metaDataProvider);\n\nexport default metaDataProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/metaDataProvider.js"],"sourceRoot":""}